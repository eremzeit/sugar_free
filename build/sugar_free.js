// Generated by CoffeeScript 1.7.1
(function() {
  var SpecsExecutor, e, fade_specs;

  fade_specs = [
    {
      site: {
        protocol: '*',
        host: 'www.bbc.com',
        path: '*'
      },
      action_list: [
        {
          element_match: {
            "class": 'page-title'
          },
          type: 'hide'
        }
      ]
    }
  ];

  SpecsExecutor = (function() {
    function SpecsExecutor(fade_specs) {
      this.fade_specs = fade_specs;
    }

    SpecsExecutor.prototype.execute = function() {
      var $matchedElements, action, spec, _i, _len, _ref, _results;
      console.log("Attempting to run SpecsExecutor");
      _ref = this.fade_specs;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        spec = _ref[_i];
        console.log("Trying spec: " + spec);
        if (this.doesMatchSite(spec.site)) {
          console.log("Executing spec: " + spec);
          _results.push((function() {
            var _j, _len1, _ref1, _results1;
            _ref1 = spec.action_list;
            _results1 = [];
            for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
              action = _ref1[_j];
              $matchedElements = this.match(action.element_match);
              _results1.push(this.doAction($matchedElements, action.type, {}));
            }
            return _results1;
          }).call(this));
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };

    SpecsExecutor.prototype.doesMatchSite = function(site_matcher) {
      console.log(site_matcher);
      console.log(location);
      return true;
      return !site_matcher.host === location.host;
    };

    SpecsExecutor.prototype.match = function(elementMatcher) {
      var fn, matched, type, value;
      if (_.isEmpty(elementMatcher)) {
        return $('*').not('*');
      }
      console.log("element_match:");
      console.log(elementMatcher);
      matched = $('*');
      for (type in elementMatcher) {
        value = elementMatcher[type];
        console.log('aeou');
        fn = this["_match_" + type];
        console.log(fn);
        matched = fn(matched, value);
      }
      return matched;
    };

    SpecsExecutor.prototype._match_id = function($matched, id) {
      return $matched.filter('#' + id);
    };

    SpecsExecutor.prototype._match_class = function($matched, cls) {
      return $matched.filter('.' + cls);
    };

    SpecsExecutor.prototype.doAction = function($elem, action_type, options) {
      return this._hide_element($elem);
    };

    SpecsExecutor.prototype._hide_element = function($elem) {
      return $elem.css('background-color', 'red');
    };

    return SpecsExecutor;

  })();

  console.log("STARTED!");

  e = new SpecsExecutor(fade_specs);

  e.execute();

}).call(this);
